<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PawShelter - Dashboard</title>
    <link rel="icon" type="image/png" href="../../images/icon/PawShelter.png">
    <link rel="shortcut icon" type="image/png" href="../../images/icon/PawShelter.png">
    <link rel="apple-touch-icon" href="../../images/icon/PawShelter.png">
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="../../css/modal.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>
<body>
    <div class="app">
        <!-- SIDEBAR loaded dynamically from sidebar.html -->

        <!-- MAIN CONTENT -->
        <main class="main-content" id="mainContent">
            <!-- CONTENT -->
            <div class="content">
                <!-- DASHBOARD SECTION -->
                <section class="page-section active" id="dashboard-section">
                    <!-- PERSONALIZED GREETING -->
                    <div class="dashboard-greeting-simple">
                        <div class="greeting-main-text">
                            <span class="greeting-time" id="greetingTime">Good Morning</span>
                            <span class="greeting-name" id="greetingName">Khairul Johari</span>
                            <span class="greeting-welcome">, Welcome back</span>
                        </div>
                        <h2 class="greeting-subtitle" id="greetingSubtitle">Your Dashboard is updated</h2>
                    </div>

                    <!-- CRITICAL ALERT BANNER (Highest Priority - First) -->
                    <div class="critical-alert-banner" id="criticalAlertBanner" style="display: none;">
                        <div class="alert-banner-content">
                            <div class="alert-banner-icon">
                                <span class="alert-icon-emoji">üö®</span>
                            </div>
                            <div class="alert-banner-text">
                                <div class="alert-banner-title" id="alertBannerTitle">Critical Alert</div>
                                <div class="alert-banner-message" id="alertBannerMessage">No critical alerts</div>
                            </div>
                            <div class="alert-banner-actions">
                                <button class="alert-action-btn" id="alertActionBtn" onclick="handleAlertAction()" title="Take Action">
                                    <span>Action</span>
                                </button>
                                <button class="alert-dismiss-btn" onclick="dismissCriticalAlert()" title="Dismiss">
                                    <span>√ó</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- KEY METRICS (Priority 1: Overview Stats) -->
                    <div class="stats-grid">
                        <div class="stat-card" onclick="window.location.href='../animals/animals.html'">
                            <div class="stat-icon blue">üêæ</div>
                            <div class="stat-value" id="totalAnimals">0</div>
                            <div class="stat-label">Total Animals</div>
                            <div class="stat-meta" id="totalAnimalsMeta">Across all species</div>
                        </div>
                        <div class="stat-card urgent-card" onclick="window.location.href='../alerts/alerts.html'">
                            <div class="stat-icon red">‚ö†Ô∏è</div>
                            <div class="stat-value" id="needAttention">0</div>
                            <div class="stat-label">Need Attention</div>
                            <div class="stat-meta" id="needAttentionMeta">Require immediate care</div>
                        </div>
                        <div class="stat-card" onclick="window.location.href='../feeding/feeding.html'">
                            <div class="stat-icon green">‚úÖ</div>
                            <div class="stat-value" id="tasksPending">0</div>
                            <div class="stat-label">Pending Feedings</div>
                            <div class="stat-meta" id="tasksPendingMeta">Scheduled today</div>
                        </div>
                        <div class="stat-card" onclick="window.location.href='../tracking/tracking.html'">
                            <div class="stat-icon purple">üìç</div>
                            <div class="stat-value" id="trackingActive">0</div>
                            <div class="stat-label">Tracking Active</div>
                            <div class="stat-meta" id="trackingBatteryMeta">Devices online</div>
                        </div>
                    </div>

                    <!-- PRIORITY 2: ACTIONABLE ITEMS (Feedings, Inventory, Map) -->
                    <div class="info-cards-container">
                        <div class="info-cards-left">
                            <!-- Upcoming Feedings Card -->
                            <div class="info-card feeding-card">
                                <div class="info-card-header">
                                    <span class="info-card-icon">üçΩÔ∏è</span>
                                    <h3 class="info-card-title">Upcoming Feedings</h3>
                                    <span class="info-card-time" id="nextFeedingTime">--:--</span>
                                </div>
                                <div class="info-card-content" id="upcomingFeedingsList">
                                    <div class="info-empty">No upcoming feedings</div>
                                </div>
                                <a href="../feeding/feeding.html" class="info-card-link">View schedule ‚Üí</a>
                            </div>

                            <!-- Low Stock Alert Card -->
                            <div class="info-card stock-card">
                                <div class="info-card-header">
                                    <span class="info-card-icon warning">üì¶</span>
                                    <h3 class="info-card-title">Inventory</h3>
                                    <span class="info-card-badge" id="lowStockCount">0</span>
                                </div>
                                <div class="info-card-content" id="lowStockList">
                                    <div class="info-empty">All items in stock</div>
                                </div>
                                <a href="../inventory/inventory.html" class="info-card-link">View inventory ‚Üí</a>
                            </div>
                        </div>

                        <!-- Live Animal Locations Map -->
                        <div class="info-card map-mini-card">
                            <div class="info-card-header">
                                <span class="info-card-icon">üìç</span>
                                <h3 class="info-card-title">Live Animal Locations</h3>
                                <span class="info-card-badge" id="miniMapCount">0</span>
                            </div>
                            <div class="info-card-content map-content">
                                <div class="mini-map-container">
                                    <div class="mini-map" id="dashboardMiniMap"></div>
                                    <div class="map-empty-overlay hidden" id="miniMapEmptyState">
                                        <div class="map-placeholder-text">No active trackers</div>
                                    </div>
                                </div>
                            </div>
                            <a href="../tracking/tracking.html" class="info-card-link">View full map ‚Üí</a>
                        </div>
                    </div>

                    <!-- PRIORITY 3: ANALYTICS & MONITORING (Health Chart, Activity, Environment) -->
                    <div class="dashboard-graphs compact-grid">
                        <!-- Health Status Chart -->
                        <div class="graph-card">
                            <div class="graph-card-header">
                                <div>
                                    <h3>Health Status</h3>
                                    <p>Animal wellness</p>
                                </div>
                            </div>
                            <canvas id="healthStatusChart"></canvas>
                        </div>

                        <!-- Recent Activity -->
                        <div class="info-card timeline-card">
                            <div class="info-card-header">
                                <span class="info-card-icon">üìÖ</span>
                                <h3 class="info-card-title">Recent Activity</h3>
                            </div>
                            <div class="info-card-content scrollable" id="activityTimeline">
                                <div class="activity-item">
                                    <div class="activity-icon">‚è≥</div>
                                    <div class="activity-content">
                                        <div class="activity-text">Loading activities...</div>
                                        <div class="activity-time">--</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Environmental Status -->
                        <div class="info-card environment-card">
                            <div class="info-card-header">
                                <span class="info-card-icon">üå°Ô∏è</span>
                                <h3 class="info-card-title">Environment</h3>
                            </div>
                            <div class="info-card-content" id="environmentStatus">
                                <div class="environment-summary">
                                    <div class="env-stat">
                                        <span class="env-label">Good</span>
                                        <span class="env-value" id="envGood">0</span>
                                    </div>
                                    <div class="env-stat">
                                        <span class="env-label">Warning</span>
                                        <span class="env-value warning" id="envWarning">0</span>
                                    </div>
                                    <div class="env-stat">
                                        <span class="env-label">Critical</span>
                                        <span class="env-value danger" id="envCritical">0</span>
                                    </div>
                                </div>
                                <div class="environment-list" id="environmentList">
                                    <div class="info-empty">No environment data</div>
                                </div>
                            </div>
                            <a href="../cage/cage.html" class="info-card-link">View cage monitor ‚Üí</a>
                        </div>
                    </div>

                </section>
            </div>
        </main>
    </div>

    <!-- TOAST -->
    <div class="toast" id="toast"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"></script>
    <script src="../data.js"></script>
    <script src="../sidebar.js"></script>
    <script src="../utils.js"></script>
    <script src="../dashboard/dashboard.js"></script>
    <script src="../modal.js"></script>
</body>
</html>